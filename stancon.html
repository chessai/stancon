<!DOCTYPE HTML><html>
<head><meta charset="utf-8"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" rel="stylesheet"><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body><div class="container"><div class="row"><div class="col-sm-12">
<h1>Getting more out of Stan: some ideas from the Haskell bindings</h1>
<h2>Introduction</h2>
<p>Probabilistic programming is one of the most promising developments in statistical computing in recent times.
By combining programming languages theory with statistical modelling, it empowers modellers with a flexible
framework for statistical computing in which a great variety of models can be expressed using composition of
arbitrary probability distributions within loop structures to express dependencies and data structure known
to or hypothesised by the modeller.</p>
<p>Probabilistic programming is distinguished from stochastic programming by the ability to condition the random
variables on observed data, that is essentially to perform the Bayesian update and move from prior to posterior
distributions. Nevertheless, probabilistic programming in its full power is not restricted only to calculating
the posterior. Computations based on this posterior may be more directly relevant to the data analyst or to the
decision maker and often require further probabilistic calculations. For instance:</p>
<ul>
<li>predicting outcomes for new observations</li>
<li>model criticism based on residuals or posterior predictive</li>
<li>forecasting</li>
<li>risk analysis</li>
<li>decision-making</li>
<li>resource allocation</li>
</ul>
<p>Stan has emerged as the most practical and widely used probabilistic programming language for Bayesian computation.
In its canonical form, Stan only calculates the posterior and leaves all further analysis to generic programming
languages. Some calculations can be done within Stan alone, but these are quite limited and tricky to apply. Most
often, post-posterior calculations are deferred to the host programming language, for instance Python or R, where
the model is rewritten to simulate. This has the disadvantage that the two models may become out of sync and some
probability distributions may be parameterised in different ways.</p>
<p>Here, we present the results of some experiments with creating bindings to Stan in Haskell, a purely functional
and statically typed programming language. Rather than present “yet another Stan binding” or even worse, try to
persuade the reader to abandon their current programming language and learn Haskell, our aim here is to present
some ideas enable a richer set of probabilistic computations from Stan models. These ideas can be implemented in
other interfaces to Stan in any language.</p>
<h2>The Haskell programming language</h2>
<p>Haskell is a lazy statically typed purely functional programming language…</p>
<p>Particularly suited for compilers and domain specific languages...</p>
<h2>Bayesian modelling in Haskell and Stan</h2>
<pre class="haskell"><code>linRegression :: [Stan]
linRegression = [
  Data [ lower 0 Int ::: &quot;n&quot;
       , lower 0 Int ::: &quot;p&quot;
       , Real ::: &quot;y&quot;![&quot;n&quot;]
       , Real ::: &quot;x&quot;![&quot;n&quot;,&quot;p&quot;]
       ],
  Parameters [
       Real ::: &quot;beta&quot;![&quot;p&quot;],
       Real ::: &quot;sigma&quot;
       ],
  Model [
          For &quot;i&quot; 1 &quot;p&quot; [&quot;beta&quot;![&quot;i&quot;] :~ normal (0.0,1.0)]
          ,&quot;sigma&quot; :~ gamma (1.0,1.0)
          ,For &quot;i&quot; 1 &quot;n&quot; [
            &quot;y&quot;![&quot;i&quot;] :~ normal ((&quot;x&quot;![&quot;i&quot;] `dot` &quot;beta&quot;), &quot;sigma&quot;)
          ]
        ]
  ]

getRow b = [rooms b, crimeRate b]


postPlotRow post vnms = row_ $ rowEven MD $ flip map vnms $ \vnm -&gt; toHtml (plotly vnm [histogram 50 $ fromJust $ Map.lookup (unpack vnm) post]
   &amp; (layout . margin) ?~ thinMargins &amp; (layout . height) ?~ 300)
</code></pre>
<pre class="haskell"><code>bh &lt;- getDataset bostonHousing

let sdata = &quot;y&quot; &lt;~ map medianValue bh &lt;&gt;
            &quot;x&quot; &lt;~ map getRow bh&lt;&gt;
            &quot;n&quot; &lt;~ length bh &lt;&gt;
            &quot;p&quot; &lt;~ length (getRow $ head bh)

res &lt;- runStan linRegression sdata sample {numSamples = 500}
seed &lt;- seedEnv &lt;$&gt; newPureMT
let resEnv = seed &lt;&gt; Map.delete &quot;y&quot; sdata &lt;&gt; mcmcToEnv res
    simEnv = runSimulateOnce linRegression resEnv
    simEnvs = runSimulate 100 linRegression resEnv
    postPredOnce = zip (unPairDoubles $ fromJust $ Map.lookup &quot;x&quot; simEnv) (unDoubles $ fromJust $ Map.lookup &quot;y&quot; simEnv)
    avgYs = avgVar simEnvs &quot;y&quot;
    residuals = zip (unPairDoubles $ fromJust $ Map.lookup &quot;x&quot; sdata)
                    $ zipWith (-) (unDoubles $ fromJust $ Map.lookup &quot;y&quot; sdata)
                                  (unDoubles avgYs)

</code></pre>
<div id="bh"></div><script>Plotly.newPlot('bh', [{"mode":"markers","x":[6.575,6.421,7.185,6.998,7.147,6.43,6.012,6.172,5.631,6.004,6.377,6.009,5.889,5.949,6.096,5.834,5.935,5.99,5.456,5.727,5.57,5.965,6.142,5.813,5.924,5.599,5.813,6.047,6.495,6.674,5.713,6.072,5.95,5.701,6.096,5.933,5.841,5.85,5.966,6.595,7.024,6.77,6.169,6.211,6.069,5.682,5.786,6.03,5.399,5.602,5.963,6.115,6.511,5.998,5.888,7.249,6.383,6.816,6.145,5.927,5.741,5.966,6.456,6.762,7.104,6.29,5.787,5.878,5.594,5.885,6.417,5.961,6.065,6.245,6.273,6.286,6.279,6.14,6.232,5.874,6.727,6.619,6.302,6.167,6.389,6.63,6.015,6.121,7.007,7.079,6.417,6.405,6.442,6.211,6.249,6.625,6.163,8.069,7.82,7.416,6.727,6.781,6.405,6.137,6.167,5.851,5.836,6.127,6.474,6.229,6.195,6.715,5.913,6.092,6.254,5.928,6.176,6.021,5.872,5.731,5.87,6.004,5.961,5.856,5.879,5.986,5.613,5.693,6.431,5.637,6.458,6.326,6.372,5.822,5.757,6.335,5.942,6.454,5.857,6.151,6.174,5.019,5.403,5.468,4.903,6.13,5.628,4.926,5.186,5.597,6.122,5.404,5.012,5.709,6.129,6.152,5.272,6.943,6.066,6.51,6.25,7.489,7.802,8.375,5.854,6.101,7.929,5.877,6.319,6.402,5.875,5.88,5.572,6.416,5.859,6.546,6.02,6.315,6.86,6.98,7.765,6.144,7.155,6.563,5.604,6.153,7.831,6.782,6.556,7.185,6.951,6.739,7.178,6.8,6.604,7.875,7.287,7.107,7.274,6.975,7.135,6.162,7.61,7.853,8.034,5.891,6.326,5.783,6.064,5.344,5.96,5.404,5.807,6.375,5.412,6.182,5.888,6.642,5.951,6.373,6.951,6.164,6.879,6.618,8.266,8.725,8.04,7.163,7.686,6.552,5.981,7.412,8.337,8.247,6.726,6.086,6.631,7.358,6.481,6.606,6.897,6.095,6.358,6.393,5.593,5.605,6.108,6.226,6.433,6.718,6.487,6.438,6.957,8.259,6.108,5.876,7.454,8.704,7.333,6.842,7.203,7.52,8.398,7.327,7.206,5.56,7.014,8.297,7.47,5.92,5.856,6.24,6.538,7.691,6.758,6.854,7.267,6.826,6.482,6.812,7.82,6.968,7.645,7.923,7.088,6.453,6.23,6.209,6.315,6.565,6.861,7.148,6.63,6.127,6.009,6.678,6.549,5.79,6.345,7.041,6.871,6.59,6.495,6.982,7.236,6.616,7.42,6.849,6.635,5.972,4.973,6.122,6.023,6.266,6.567,5.705,5.914,5.782,6.382,6.113,6.426,6.376,6.041,5.708,6.415,6.431,6.312,6.083,5.868,6.333,6.144,5.706,6.031,6.316,6.31,6.037,5.869,5.895,6.059,5.985,5.968,7.241,6.54,6.696,6.874,6.014,5.898,6.516,6.635,6.939,6.49,6.579,5.884,6.728,5.663,5.936,6.212,6.395,6.127,6.112,6.398,6.251,5.362,5.803,8.78,3.561,4.963,3.863,4.97,6.683,7.016,6.216,5.875,4.906,4.138,7.313,6.649,6.794,6.38,6.223,6.968,6.545,5.536,5.52,4.368,5.277,4.652,5,4.88,5.39,5.713,6.051,5.036,6.193,5.887,6.471,6.405,5.747,5.453,5.852,5.987,6.343,6.404,5.349,5.531,5.683,4.138,5.608,5.617,6.852,5.757,6.657,4.628,5.155,4.519,6.434,6.782,5.304,5.957,6.824,6.411,6.006,5.648,6.103,5.565,5.896,5.837,6.202,6.193,6.38,6.348,6.833,6.425,6.436,6.208,6.629,6.461,6.152,5.935,5.627,5.818,6.406,6.219,6.485,5.854,6.459,6.341,6.251,6.185,6.417,6.749,6.655,6.297,7.393,6.728,6.525,5.976,5.936,6.301,6.081,6.701,6.376,6.317,6.513,6.209,5.759,5.952,6.003,5.926,5.713,6.167,6.229,6.437,6.98,5.427,6.162,6.484,5.304,6.185,6.229,6.242,6.75,7.061,5.762,5.871,6.312,6.114,5.905,5.454,5.414,5.093,5.983,5.983,5.707,5.926,5.67,5.39,5.794,6.019,5.569,6.027,6.593,6.12,6.976,6.794,6.03],"type":"scatter","y":[24,21.6,34.7,33.4,36.2,28.7,22.9,27.1,16.5,18.9,15,18.9,21.7,20.4,18.2,19.9,23.1,17.5,20.2,18.2,13.6,19.6,15.2,14.5,15.6,13.9,16.6,14.8,18.4,21,12.7,14.5,13.2,13.1,13.5,18.9,20,21,24.7,30.8,34.9,26.6,25.3,24.7,21.2,19.3,20,16.6,14.4,19.4,19.7,20.5,25,23.4,18.9,35.4,24.7,31.6,23.3,19.6,18.7,16,22.2,25,33,23.5,19.4,22,17.4,20.9,24.2,21.7,22.8,23.4,24.1,21.4,20,20.8,21.2,20.3,28,23.9,24.8,22.9,23.9,26.6,22.5,22.2,23.6,28.7,22.6,22,22.9,25,20.6,28.4,21.4,38.7,43.8,33.2,27.5,26.5,18.6,19.3,20.1,19.5,19.5,20.4,19.8,19.4,21.7,22.8,18.8,18.7,18.5,18.3,21.2,19.2,20.4,19.3,22,20.3,20.5,17.3,18.8,21.4,15.7,16.2,18,14.3,19.2,19.6,23,18.4,15.6,18.1,17.4,17.1,13.3,17.8,14,14.4,13.4,15.6,11.8,13.8,15.6,14.6,17.8,15.4,21.5,19.6,15.3,19.4,17,15.6,13.1,41.3,24.3,23.3,27,50,50,50,22.7,25,50,23.8,23.8,22.3,17.4,19.1,23.1,23.6,22.6,29.4,23.2,24.6,29.9,37.2,39.8,36.2,37.9,32.5,26.4,29.6,50,32,29.8,34.9,37,30.5,36.4,31.1,29.1,50,33.3,30.3,34.6,34.9,32.9,24.1,42.3,48.5,50,22.6,24.4,22.5,24.4,20,21.7,19.3,22.4,28.1,23.7,25,23.3,28.7,21.5,23,26.7,21.7,27.5,30.1,44.8,50,37.6,31.6,46.7,31.5,24.3,31.7,41.7,48.3,29,24,25.1,31.5,23.7,23.3,22,20.1,22.2,23.7,17.6,18.5,24.3,20.5,24.5,26.2,24.4,24.8,29.6,42.8,21.9,20.9,44,50,36,30.1,33.8,43.1,48.8,31,36.5,22.8,30.7,50,43.5,20.7,21.1,25.2,24.4,35.2,32.4,32,33.2,33.1,29.1,35.1,45.4,35.4,46,50,32.2,22,20.1,23.2,22.3,24.8,28.5,37.3,27.9,23.9,21.7,28.6,27.1,20.3,22.5,29,24.8,22,26.4,33.1,36.1,28.4,33.4,28.2,22.8,20.3,16.1,22.1,19.4,21.6,23.8,16.2,17.8,19.8,23.1,21,23.8,23.1,20.4,18.5,25,24.6,23,22.2,19.3,22.6,19.8,17.1,19.4,22.2,20.7,21.1,19.5,18.5,20.6,19,18.7,32.7,16.5,23.9,31.2,17.5,17.2,23.1,24.5,26.6,22.9,24.1,18.6,30.1,18.2,20.6,17.8,21.7,22.7,22.6,25,19.9,20.8,16.8,21.9,27.5,21.9,23.1,50,50,50,50,50,13.8,13.8,15,13.9,13.3,13.1,10.2,10.4,10.9,11.3,12.3,8.8,7.2,10.5,7.4,10.2,11.5,15.1,23.2,9.7,13.8,12.7,13.1,12.5,8.5,5,6.3,5.6,7.2,12.1,8.3,8.5,5,11.9,27.9,17.2,27.5,15,17.2,17.9,16.3,7,7.2,7.5,10.4,8.8,8.4,16.7,14.2,20.8,13.4,11.7,8.3,10.2,10.9,11,9.5,14.5,14.1,16.1,14.3,11.7,13.4,9.6,8.7,8.4,12.8,10.5,17.1,18.4,15.4,10.8,11.8,14.9,12.6,14.1,13,13.4,15.2,16.1,17.8,14.9,14.1,12.7,13.5,14.9,20,16.4,17.7,19.5,20.2,21.4,19.9,19,19.1,19.1,20.1,19.9,19.6,23.2,29.8,13.8,13.3,16.7,12,14.6,21.4,23,23.7,25,21.8,20.6,21.2,19.1,20.6,15.2,7,8.1,13.6,20.1,21.8,24.5,23.1,19.7,18.3,21.2,17.5,16.8,22.4,20.6,23.9,22,11.9]}],{}, {displayModeBar: false});</script>
<div id="bhpp"></div><script>Plotly.newPlot('bhpp', [{"mode":"markers","x":[6.575,6.421,7.185,6.998,7.147,6.43,6.012,6.172,5.631,6.004,6.377,6.009,5.889,5.949,6.096,5.834,5.935,5.99,5.456,5.727,5.57,5.965,6.142,5.813,5.924,5.599,5.813,6.047,6.495,6.674,5.713,6.072,5.95,5.701,6.096,5.933,5.841,5.85,5.966,6.595,7.024,6.77,6.169,6.211,6.069,5.682,5.786,6.03,5.399,5.602,5.963,6.115,6.511,5.998,5.888,7.249,6.383,6.816,6.145,5.927,5.741,5.966,6.456,6.762,7.104,6.29,5.787,5.878,5.594,5.885,6.417,5.961,6.065,6.245,6.273,6.286,6.279,6.14,6.232,5.874,6.727,6.619,6.302,6.167,6.389,6.63,6.015,6.121,7.007,7.079,6.417,6.405,6.442,6.211,6.249,6.625,6.163,8.069,7.82,7.416,6.727,6.781,6.405,6.137,6.167,5.851,5.836,6.127,6.474,6.229,6.195,6.715,5.913,6.092,6.254,5.928,6.176,6.021,5.872,5.731,5.87,6.004,5.961,5.856,5.879,5.986,5.613,5.693,6.431,5.637,6.458,6.326,6.372,5.822,5.757,6.335,5.942,6.454,5.857,6.151,6.174,5.019,5.403,5.468,4.903,6.13,5.628,4.926,5.186,5.597,6.122,5.404,5.012,5.709,6.129,6.152,5.272,6.943,6.066,6.51,6.25,7.489,7.802,8.375,5.854,6.101,7.929,5.877,6.319,6.402,5.875,5.88,5.572,6.416,5.859,6.546,6.02,6.315,6.86,6.98,7.765,6.144,7.155,6.563,5.604,6.153,7.831,6.782,6.556,7.185,6.951,6.739,7.178,6.8,6.604,7.875,7.287,7.107,7.274,6.975,7.135,6.162,7.61,7.853,8.034,5.891,6.326,5.783,6.064,5.344,5.96,5.404,5.807,6.375,5.412,6.182,5.888,6.642,5.951,6.373,6.951,6.164,6.879,6.618,8.266,8.725,8.04,7.163,7.686,6.552,5.981,7.412,8.337,8.247,6.726,6.086,6.631,7.358,6.481,6.606,6.897,6.095,6.358,6.393,5.593,5.605,6.108,6.226,6.433,6.718,6.487,6.438,6.957,8.259,6.108,5.876,7.454,8.704,7.333,6.842,7.203,7.52,8.398,7.327,7.206,5.56,7.014,8.297,7.47,5.92,5.856,6.24,6.538,7.691,6.758,6.854,7.267,6.826,6.482,6.812,7.82,6.968,7.645,7.923,7.088,6.453,6.23,6.209,6.315,6.565,6.861,7.148,6.63,6.127,6.009,6.678,6.549,5.79,6.345,7.041,6.871,6.59,6.495,6.982,7.236,6.616,7.42,6.849,6.635,5.972,4.973,6.122,6.023,6.266,6.567,5.705,5.914,5.782,6.382,6.113,6.426,6.376,6.041,5.708,6.415,6.431,6.312,6.083,5.868,6.333,6.144,5.706,6.031,6.316,6.31,6.037,5.869,5.895,6.059,5.985,5.968,7.241,6.54,6.696,6.874,6.014,5.898,6.516,6.635,6.939,6.49,6.579,5.884,6.728,5.663,5.936,6.212,6.395,6.127,6.112,6.398,6.251,5.362,5.803,8.78,3.561,4.963,3.863,4.97,6.683,7.016,6.216,5.875,4.906,4.138,7.313,6.649,6.794,6.38,6.223,6.968,6.545,5.536,5.52,4.368,5.277,4.652,5,4.88,5.39,5.713,6.051,5.036,6.193,5.887,6.471,6.405,5.747,5.453,5.852,5.987,6.343,6.404,5.349,5.531,5.683,4.138,5.608,5.617,6.852,5.757,6.657,4.628,5.155,4.519,6.434,6.782,5.304,5.957,6.824,6.411,6.006,5.648,6.103,5.565,5.896,5.837,6.202,6.193,6.38,6.348,6.833,6.425,6.436,6.208,6.629,6.461,6.152,5.935,5.627,5.818,6.406,6.219,6.485,5.854,6.459,6.341,6.251,6.185,6.417,6.749,6.655,6.297,7.393,6.728,6.525,5.976,5.936,6.301,6.081,6.701,6.376,6.317,6.513,6.209,5.759,5.952,6.003,5.926,5.713,6.167,6.229,6.437,6.98,5.427,6.162,6.484,5.304,6.185,6.229,6.242,6.75,7.061,5.762,5.871,6.312,6.114,5.905,5.454,5.414,5.093,5.983,5.983,5.707,5.926,5.67,5.39,5.794,6.019,5.569,6.027,6.593,6.12,6.976,6.794,6.03],"type":"scatter","y":[20.422649396092005,13.82446000839862,16.933592739941204,20.01662036562825,27.7878845909915,8.047676513295098,38.71825929179599,29.469103370436123,32.33186143576626,27.458719661737582,40.63762788748764,32.007441161752396,18.180339157389987,20.89516112408764,26.663075121540967,25.367156350455407,21.516878062410253,28.008651585522728,30.92642029887292,26.9861501672638,17.70545647779013,28.65957932274563,22.883019629717165,26.690455014250027,20.733378586165873,13.448195476115723,22.939056320312968,22.392999534058823,21.453951441683017,28.17769049325008,23.200523649006836,19.983909779203344,22.724487618954047,16.943371988121847,5.933618789813536,27.414613058862198,32.489444386439416,23.99567138846888,26.033097528441644,24.634812880824413,28.13381356978014,33.10298831570206,23.853570643712512,12.528277069601339,24.52449960397906,11.833906367554532,17.47669074037914,26.351060978282867,19.963027263493707,32.83611786534183,37.76310361726469,18.874732735503365,25.71894956983436,19.484732312904423,12.178006778420757,35.349600885994626,22.790671374230012,28.863984763911446,28.91814643697045,24.359862896885073,12.965397089198225,19.550093133182198,26.112765691278575,31.170399900375294,34.63433217386776,22.652170018373095,25.021656819932673,17.038580571926847,34.19773522893466,23.018771558408528,11.013173857030461,19.875666015555797,17.581138218975013,28.282030271984063,15.113018944284038,25.82781935631038,14.383651320659729,26.46570578616606,16.328031780415394,21.40517184773988,27.00098800485592,39.259055679306876,20.660201709801896,23.12446877851404,12.320196958953822,26.54299335707248,25.055140244542564,27.718432133255977,35.23479839115328,26.458790912491512,21.11013766181842,19.267809697978898,26.82728276419347,23.10258556728731,24.869326869926997,28.940258827920477,35.83048810784067,37.66345268714496,33.99400741802282,29.806665417682353,30.67608103445102,32.262224326283516,26.277042114529273,24.799307888589006,15.22540202634346,27.004048932902908,24.85688360842446,27.078501312722775,21.901525396245066,30.80919873987067,28.181557135176973,20.712514930006208,15.865130780978305,22.66950960378417,39.55231961069713,19.340700761213196,11.499379830014892,32.073982431307684,20.85638301759477,19.61737180080049,14.035010992797844,19.071190304465052,21.968296841876445,14.29079067073807,29.696997828964292,18.79381486431454,13.948627193115684,20.612789215687513,27.748150885127878,20.22357912910596,17.878428118964397,23.558281222027848,27.30999454703507,19.64402732154328,22.659431640314523,30.277899847059537,21.980001224708783,32.69739840357263,19.276980551691842,15.306101069005425,27.66036139987377,27.078013936145574,13.448825741605955,19.547241167031956,17.346688789914808,25.537646638948008,30.22232652195447,20.9543200093753,21.56998065356826,21.03291709622189,17.072288930722433,16.876242959964,7.414390560023611,21.37825975113296,8.943150723374954,18.527228773681028,11.224598923200892,20.972586225919184,23.234205406356384,20.966499118360097,31.841188069400225,21.97250447637189,11.655614465895404,31.790157057211566,24.416434960761716,13.859997474561384,29.48076866401664,33.540831741312765,31.239306347731976,39.06505642007329,23.04664442990056,23.398562352106246,18.19436753341295,23.36743636451101,12.589363396209249,16.57359497898313,30.374523986278156,35.37917683830909,44.71323154417599,30.713359877693815,27.95307907353952,22.12330137490418,32.16996149650583,37.60623726645914,27.535862758694467,30.835705821282872,34.02090662606551,26.12704461366345,15.230644676563449,31.598600489548783,28.615025784845336,35.29091767128849,25.768336460983054,27.16252250475657,23.341829361101972,25.314494668606024,28.204025546799574,24.189822286763878,39.70113962765672,37.62859109812085,32.155190586796735,33.131698055932986,29.4157735622214,29.004877385478405,17.484197023644597,26.22573449958244,17.80989651704472,22.111717250677525,26.186491430429406,26.730798700635805,26.86861613897602,26.72773949080826,37.80166281586847,33.544937806924786,28.284557881727796,33.46285159972493,14.393669841854663,23.366877944644102,24.69441975087773,23.46305623400722,27.782125588473676,30.515846153845686,22.582544624615842,16.803343274662993,28.127164606490087,24.60620404586229,15.933226966128672,38.56352318749281,14.994564443835278,31.970187250668424,30.841490221483504,28.389725116569906,35.270552454005546,10.718965417586496,14.177663412423325,27.770916051043343,32.61961652654303,24.656539928197006,18.022386399716947,21.82797300030955,25.697617615262843,43.99197646863894,20.895072938468875,20.35614252614505,20.18378721103858,12.403280525174694,23.1783342725372,17.349870665001617,35.200923847435746,17.43111283710022,32.91168479980041,27.294051036507437,26.426285839338043,26.253950560534747,23.567687753976127,14.814712726361039,28.087658893880292,50.74501709891973,16.67576136067882,24.914960489469074,27.38651704730897,32.035549101814595,25.473941595293134,39.1820700983513,26.501887977369663,18.259423803989073,29.29302882946707,26.2167950833565,24.478142990015158,19.693354019193062,22.677708572765994,36.92682227678288,35.6202524300732,33.53535442029849,21.79767458286229,26.967834586979432,19.48425660551395,29.18267246923813,17.527302663475965,29.35892185449489,36.80530060992884,36.20138725826851,30.50614916212767,26.68006233090097,29.7278684070435,7.254760889028393,21.269374254325445,19.193285868260723,28.854152015056776,28.78550358255009,24.088142265915845,22.436804915213024,19.43951090120305,31.024128769624525,19.9202667012078,12.340494794175576,11.26710837286853,26.51286704410592,19.592355018104325,27.469569645617145,32.77148081613456,31.31648635494996,32.42574586892878,33.36453544454548,18.622189623801027,27.860626010190945,22.583430222479645,29.74075113194702,28.625957122699617,25.35450603996094,15.31514355570398,37.31250158418004,32.22910687788193,10.604838165867813,27.595634641612595,24.004711396194942,24.308146632452857,-3.552267142410372,22.314597575013387,17.453604103584258,24.42005678172258,18.819942452411617,15.031166987029394,28.62896432821786,19.965608553307447,31.55333855894344,16.324119668131473,8.066201582543503,30.856950579580936,17.679366257982053,16.302808205050752,24.50994830243137,14.478106248416369,27.4286182047908,29.06988480527099,27.46505021122285,21.820891484785967,10.630862593308574,14.480415622222973,15.886251578203861,14.835119539331965,20.574043454444478,27.73518722846021,20.908279788343364,20.047184001565178,21.955864059149512,20.81640891878124,15.79734547543556,20.891245487342587,27.425448036455133,17.020222974050768,28.3583017511867,26.82502616349105,28.730034609817213,19.976094284105315,11.515967205710492,21.378100133070777,19.382702110406854,20.928025437381958,21.97242943464251,28.54714082934293,21.308708989379923,14.196550606889268,19.9733039248251,36.201539004854624,14.70592988505109,11.412145580758715,13.631068385787563,17.686977254832566,34.39784693448205,35.913420928911016,27.052904354416707,14.162773235285979,4.449536849692416,9.764571167407883,26.064656385596585,23.783146843158,19.200013800523003,7.157253748420628,26.83637366030107,-6.346518922962458,24.364351118917266,24.05620265082112,17.490758916543317,7.9650327699716446,14.458154751079995,18.341568865055315,17.12136024981373,3.3225687573855733,15.864367769510503,17.29549438725471,25.746713371912126,5.676181848502468,30.357591922259452,16.049560933963544,25.800560928212295,33.559091059069736,21.313406081731735,4.9775430842220505,23.93209525772022,21.543550701408968,17.761139643055174,29.938988959953097,9.269936752620726,0.7669446749459574,-5.82606883579877e-2,6.303305357705909,12.203973526703892,33.12259778240297,23.81591581937518,-0.11691534271095794,11.139994551239688,27.7957948161962,6.694583071587801,16.19638987329327,11.430817723809858,17.58957883527538,16.792625986367593,-2.133573982123775,24.127907581264022,25.125929185393645,17.40385214425193,13.20628649536144,29.13566259187396,18.856163029258934,16.61789591171571,16.017243712415866,15.73539453757073,19.583376604228132,19.405719312505475,21.08935834712463,14.403260911249841,28.775269193981526,27.918778268412368,23.18684238303609,19.796848504509093,15.313892165138775,19.528802714027837,18.029768974643385,18.22847797336751,22.068538289467483,17.20970431229871,21.194959191064864,17.338214239073213,21.073629553825853,20.38797463545049,16.748206478868944,19.313148802293288,20.28156649685197,15.718841382963069,8.415339886792886,26.10549398051888,16.7843094114606,25.071590736959223,17.507312796801866,26.424896360484325,12.779505874818645,29.952649688340152,19.91571827046119,22.70955242846389,18.781630500925278,21.668109786687506,25.884141972953536,23.7591771101171,16.267930083778715,20.511892345470677,22.948369302968995,24.83439599063015,18.080967966469622,13.3930326615265,13.742186800817441,30.051907872738568,30.53373466920329,21.069746879969976,21.64587320820445,25.520170959693697,13.262545762579569,14.467384270604251,16.620620138735468,20.183593695421354,24.99863131794902,20.254463588686686,22.908820805720307,9.805326128066175,25.84950633954783,29.714487915585437,31.46302404449109,18.898229640162306,26.879970299679364,20.824565672230552,18.150226428894516,25.289291747028045,29.2404333416176,25.342632385124194,14.684942166191112,26.016773486117877,21.373019190922736,21.46132384533306,19.147609873724015,17.223027836243972,24.79968616192074,40.178636097559576,18.101735653784225,23.521634650845442,19.697355032313396,25.50250281376043]}],{}, {displayModeBar: false});</script>
<div id="bhres"></div><script>Plotly.newPlot('bhres', [{"mode":"markers","x":[6.575,6.421,7.185,6.998,7.147,6.43,6.012,6.172,5.631,6.004,6.377,6.009,5.889,5.949,6.096,5.834,5.935,5.99,5.456,5.727,5.57,5.965,6.142,5.813,5.924,5.599,5.813,6.047,6.495,6.674,5.713,6.072,5.95,5.701,6.096,5.933,5.841,5.85,5.966,6.595,7.024,6.77,6.169,6.211,6.069,5.682,5.786,6.03,5.399,5.602,5.963,6.115,6.511,5.998,5.888,7.249,6.383,6.816,6.145,5.927,5.741,5.966,6.456,6.762,7.104,6.29,5.787,5.878,5.594,5.885,6.417,5.961,6.065,6.245,6.273,6.286,6.279,6.14,6.232,5.874,6.727,6.619,6.302,6.167,6.389,6.63,6.015,6.121,7.007,7.079,6.417,6.405,6.442,6.211,6.249,6.625,6.163,8.069,7.82,7.416,6.727,6.781,6.405,6.137,6.167,5.851,5.836,6.127,6.474,6.229,6.195,6.715,5.913,6.092,6.254,5.928,6.176,6.021,5.872,5.731,5.87,6.004,5.961,5.856,5.879,5.986,5.613,5.693,6.431,5.637,6.458,6.326,6.372,5.822,5.757,6.335,5.942,6.454,5.857,6.151,6.174,5.019,5.403,5.468,4.903,6.13,5.628,4.926,5.186,5.597,6.122,5.404,5.012,5.709,6.129,6.152,5.272,6.943,6.066,6.51,6.25,7.489,7.802,8.375,5.854,6.101,7.929,5.877,6.319,6.402,5.875,5.88,5.572,6.416,5.859,6.546,6.02,6.315,6.86,6.98,7.765,6.144,7.155,6.563,5.604,6.153,7.831,6.782,6.556,7.185,6.951,6.739,7.178,6.8,6.604,7.875,7.287,7.107,7.274,6.975,7.135,6.162,7.61,7.853,8.034,5.891,6.326,5.783,6.064,5.344,5.96,5.404,5.807,6.375,5.412,6.182,5.888,6.642,5.951,6.373,6.951,6.164,6.879,6.618,8.266,8.725,8.04,7.163,7.686,6.552,5.981,7.412,8.337,8.247,6.726,6.086,6.631,7.358,6.481,6.606,6.897,6.095,6.358,6.393,5.593,5.605,6.108,6.226,6.433,6.718,6.487,6.438,6.957,8.259,6.108,5.876,7.454,8.704,7.333,6.842,7.203,7.52,8.398,7.327,7.206,5.56,7.014,8.297,7.47,5.92,5.856,6.24,6.538,7.691,6.758,6.854,7.267,6.826,6.482,6.812,7.82,6.968,7.645,7.923,7.088,6.453,6.23,6.209,6.315,6.565,6.861,7.148,6.63,6.127,6.009,6.678,6.549,5.79,6.345,7.041,6.871,6.59,6.495,6.982,7.236,6.616,7.42,6.849,6.635,5.972,4.973,6.122,6.023,6.266,6.567,5.705,5.914,5.782,6.382,6.113,6.426,6.376,6.041,5.708,6.415,6.431,6.312,6.083,5.868,6.333,6.144,5.706,6.031,6.316,6.31,6.037,5.869,5.895,6.059,5.985,5.968,7.241,6.54,6.696,6.874,6.014,5.898,6.516,6.635,6.939,6.49,6.579,5.884,6.728,5.663,5.936,6.212,6.395,6.127,6.112,6.398,6.251,5.362,5.803,8.78,3.561,4.963,3.863,4.97,6.683,7.016,6.216,5.875,4.906,4.138,7.313,6.649,6.794,6.38,6.223,6.968,6.545,5.536,5.52,4.368,5.277,4.652,5,4.88,5.39,5.713,6.051,5.036,6.193,5.887,6.471,6.405,5.747,5.453,5.852,5.987,6.343,6.404,5.349,5.531,5.683,4.138,5.608,5.617,6.852,5.757,6.657,4.628,5.155,4.519,6.434,6.782,5.304,5.957,6.824,6.411,6.006,5.648,6.103,5.565,5.896,5.837,6.202,6.193,6.38,6.348,6.833,6.425,6.436,6.208,6.629,6.461,6.152,5.935,5.627,5.818,6.406,6.219,6.485,5.854,6.459,6.341,6.251,6.185,6.417,6.749,6.655,6.297,7.393,6.728,6.525,5.976,5.936,6.301,6.081,6.701,6.376,6.317,6.513,6.209,5.759,5.952,6.003,5.926,5.713,6.167,6.229,6.437,6.98,5.427,6.162,6.484,5.304,6.185,6.229,6.242,6.75,7.061,5.762,5.871,6.312,6.114,5.905,5.454,5.414,5.093,5.983,5.983,5.707,5.926,5.67,5.39,5.794,6.019,5.569,6.027,6.593,6.12,6.976,6.794,6.03],"type":"scatter","y":[-1.0944432243822213,-2.630878920498283,8.315045607659933,7.010065056096952,8.563160783826536,3.5570870380345347,-0.8098493150241168,2.4808610639829105,-5.811961123855053,-3.6457138907062863,-10.34494099064894,-3.867798502103785,-0.9197797399343024,-1.5812225618455997,-3.8983336403115025,-0.6919949073962819,1.55721513662537,-5.150072912150467,-1.4165800507491824,-4.197872233554627,-6.882596437208301,-3.7359639143708954,-6.715411950537657,-8.41703508237929,-5.9809273105238905,-7.091867358874103,-5.528549029887632,-7.8420031578709555,-7.088446641831013,-4.743037528381766,-9.643143432915068,-7.905877774025743,-9.493938668754694,-8.089456025213492,-8.345288493234445,-2.5616219550960615,-3.6831848033013124,-1.0688331529265582,2.3227108430693484,5.6990930428874975,8.183440112216275,-0.45991555472275536,0.18533596791665374,1.7085882164803685,-0.7254983402405628,-2.778436923402154,-2.120476913780923,-7.46232377178676,-6.878833628361418,-2.0803720506596868,-1.7580748225374556,-2.08383604425779,-1.1487603285154506,-0.30670439292501683,-4.414261309373998,8.034321281252527,-4.448791818632003e-3,6.673352950132582,0.17025968585096862,-3.1977308421099266,-2.8339985516885484,-6.85437604294421,-2.449557377287128,-0.6917519807551535,4.337563084500026,-1.647225479984094,-2.2977439615093935,-0.7150395651717183,-4.065456366593697,-0.6640008055029263,-0.7299165964866852,-1.5648510423938795,0.11471694328441018,-0.45547268225952564,0.23350168881515643,-3.1601579543765084,-4.741168657475143,-3.895692755752229,-1.8544029233570285,-2.4446441371003935,2.3864639745903453,-0.83024864133737,0.6698222382102195,-1.653541780488215,0.2867602463237908,1.648832992481232,-0.9836656972258915,-0.532712687252122,-3.0694779044770577,1.679552404899976,-0.7536097969575657,-3.1089085996663925,-1.3262107593817802,1.0767584670480375,-3.5051007518437878,3.959209166207277,-2.1211225000930156,7.475604962018327,13.997997984292702,4.563333361096468,1.239124822013622,0.34297555738082863,-5.92313596978661,-3.6864212112586223,-4.140252365025898,-3.1666344575868024,-3.198813192880138,-3.818066456558423,-5.888242733629394,-3.1236301644794295,-3.043033740232488,-3.4210647042079962,-3.258085185770387,-5.237289768826265,-6.061709793479,-4.547102859103774,-1.870124531278723,-4.556093765062343,-3.886907689643884,-3.5813946153700087,0.5565559155750641,-2.875502254276192,-2.131718766101649,-4.4396459906915275,-3.316281300805329,-1.144734629535698,-6.3514577884355,-4.93778321642186,-6.783424897989686,-6.5110384121539155,-5.119562739156507,-3.3640223289086038,-0.6318761042503738,-4.171546851733581,-5.388924032737814,-5.169856644128547,-6.687001505440797,-7.180481478798487,-9.256142651443334,-6.034161705648934,-9.594148096658195,-4.972738734939659,-6.475596395286933,-4.298835321369333,-5.578274752748861,-8.613763142832976,-6.331298534009642,-4.177777163596081,-1.3157383280699442,-4.4311020559995935,-1.3005033821212848,-0.5593004634032539,-3.3532341135310944,-2.208701697090966,-6.642273277853096,-7.235333926900077,-7.3021747428091235,14.395367211489862,0.6308291924820324,-0.9256746851595921,3.463356275809474,20.80613517227211,21.504847724346327,18.239518049869623,-0.47701328943708177,3.159904380004523,19.801474857718915,0.7029567788971178,-0.8444521851543563,-1.7716146354876408,-4.583486836728813,-2.5757163173902278,0.8502849163330026,-1.7801153590339034,-0.9973218421028562,3.914350990828982,-1.314412761252452,1.105835363929124,3.3918965117442816,9.836740893903727,9.86701746216744,13.901765529447161,10.624131838075922,8.058272174592581,4.62043064512854,4.531474901886554,20.98698968468125,5.672367527933432,5.843243782135183,7.665740259995236,10.993698153770879,2.7118674010883517,8.903697308357067,4.254253002695297,3.996054667553036,20.705553285908575,5.501438755121658,2.8552984077996904,6.344029223573507,8.030736728218265,5.217310577792407,0.4600987269074359,12.876038677525028,18.019286272394595,19.804068313457798,-0.21386090901867405,0.7429780677394575,1.0126391131414678,1.3453575856855693,-2.31526058914433e-2,-1.6508726272453664,-0.9691050931303415,0.20813924368765413,3.6267407236977043,3.7198301546526906,1.5586353228116288,0.5299478578301127,3.571068686365308,-2.5435384261306773,-1.2336495752193564,0.8877621852253093,-2.641493618598453,1.6165971448268976,4.9320140191004995,13.748370255366218,17.13241388676152,7.293613114265135,3.891267001199978,16.928649931926508,6.130822166692177,1.9067679450896726,4.186054848479841,9.623374850796985,16.126565021811523,4.4401301872903645,0.24280379529068696,-4.922021628719975e-2,2.8873530447498688,-0.4725146441087418,-1.1579818144075524,-5.514466917670472,-3.643397464618893,-1.5295288461937275,-1.7750922572252357,-3.6627640399501757,-4.161059684209942,1.7977189620164928,-1.4137513702251923,-0.5469872161397689,0.9946095708850677,-0.16858948567293552,8.999382188283178e-2,3.559471451408271,11.483030335939201,-0.7766972511737968,-0.797266965827049,16.523995667945165,16.82738857219522,10.159404793755535,4.4718416086525,5.655250428007836,13.982903196515007,17.57664587408274,2.612643345832648,9.250233743630503,1.418335691287794,3.9425154722645246,17.456618633848272,15.862811046408769,-0.9765754817487213,-1.6090500197367597,2.247857835885192,-0.5927582864804108,5.871704623159431,7.742803951500306,5.68978221742238,6.150177091909452,6.077569333334036,4.3943306313650154,9.064797224428382,16.79717749636938,8.958554642775141,16.197028306425008,19.994292471432335,5.661038331876579,-4.307271664306164,-3.334392127112327,-1.6774291406977504,-2.7050781241019024,-1.0675336021001023,3.436925288174617,9.78115468582477,2.7438989983657933,0.13740654977925004,-2.2509582105363144,3.17840648390618,0.3292959581574735,-0.9463135723784255,-2.4567276014310124,2.0596438436113758,-1.6416024926576789,-3.156950350365566,1.7330144207218936,5.432990026981393,8.756248374973726,3.3666931462028558,6.341368092045979,0.6628593358608157,-2.854455144925776,-1.431471036906995,-1.101602175281318,-1.043457795967715,-3.489937658384939,-3.192534888288474,-0.8310398431206529,-6.964475547522735,-5.217395196982988,-2.214102999527313,-1.0260348610828167,-2.7388711795486387,-1.8512755564328423,-1.4050141073940843,-3.4464206254216663,-3.055412970709959,1.9190530871170814,-0.22000135449188107,0.29739129662253205,-1.6728261284596186,-2.9329427761112505,-0.4647178687907356,-2.4142367025951543,-4.061168365360853,-2.974536285186506,-1.252316056025748,-3.6469591208672654,-2.222910208742732,-4.014790106379873,-5.279195009654838,-1.4378241881931828,-4.477664728046019,-3.258817673150368,5.295632591733,-8.903695477009812,-1.2581222293797012,4.455811182200286,-4.226478666177417,-4.433483215440113,-2.821317100731001,-0.6107685300332051,-0.1787115162643822,-1.5240307652925296,-0.6631133632296304,-3.5379069368582527,5.334361679271684,-2.8082444315580517,-1.6377980264743357,-4.25132033718873,0.17522194723736462,2.5154540800261707,0.4133831397541208,2.435652611674744,-2.6986033323162317,1.730244018768591,-3.4781605739599755,-11.01585561275241,16.00047072186912,3.738607630032945,11.993047599761345,32.82369482481438,25.752194525273158,24.71640106799693,29.252332569325375,31.268970159743237,-0.11595108213762373,4.039462431231341,-6.861410755235333,-6.274001375165382,-8.61585969759593,-3.1274262051284882,-8.12560827398886,17.06047798711376,-7.732032180254896,-5.767594623682367,-4.5109889092940065,-1.0714109511339167,-6.251190847264724,1.9966197954127658,-3.86228891427219,-3.45611772382002,-5.647702978746498,-5.016273542037174,2.7943898351121312,-5.219234549379243,-7.1457105223952695,-5.558420049701201,-7.907905275105913,-10.097506045868272,-11.833758960537182,-1.6176489793170035,-13.374235215432709,-7.523148916233273,-12.246408374888624,-10.633387700494504,-2.4971560461981213,2.242810172875145,8.382375931571648,4.501356198071721,9.816305785598171,-2.5184740291423324,7.084058732999875,11.231774776085766,-4.004151012714171,6.722236977329425,7.152629660086173,6.391987007339201,-11.86848611221426,-15.76700708696226,-1.1413610200079276,12.004223130566807,-13.642644810212326,-3.1586306675673725,-5.6919203623203,3.551806298310211,-7.045428168294544,-5.918181571936088,-8.180967313936197,-7.042825104052536,1.2689894843650027,-9.356975220975315,-11.746658226759852,-6.362310191827547,-8.045802224372514,-6.201004783610681,-8.31921057524372,-6.30137993748945,-7.911551450717193,-9.46651136787552,-8.886039274533491,-10.402255318106073,-5.09997089200969,-3.942142746544107,-2.961217161618059,-2.6203093889565956,-6.46475551932164,-6.8409234697412735,-9.351002810412218,-6.2110829454203955,-7.031954016949575,-6.5842016439502284,-8.731018257990378,-8.297368938518867,-9.549039620050191,-7.474454567214629,-7.506634551318129,-7.478982432652591,-10.510491276170002,-9.897950815336685,-6.831028262830301,-6.893850625997578,-1.755983029622577,-6.86599098839277,-5.2376540119813875,-3.1636968697039087,-2.481595434212686,1.4663708799599604,-1.2906699486098603,-1.7056969522869565,-1.9734654768020157,2.6130804521192275,3.150727681250423,-2.6221703298564343,-2.8042499339910734,0.835987668531228,4.108274979405273,-5.335682733930419,-9.055354330977774,-4.99842172945835,-1.371912632543907,-5.5527934117122175,3.2320655144921027,2.67961308609722,-1.3207160660850938,-0.4091093993505872,1.6057999191699963,-0.4322516027810259,-1.3064166887334387,-3.5248864352368763,-1.8716033097818574,-6.202414523697318,-14.842855583054007,-11.77406659013633,-8.744046792887579,-2.986622812436412,-0.21494615637410774,2.217687150237751,1.5303585451080224,-0.8083532484632521,-3.809899693251168,-2.3783996226560156,-2.3187209815579806,-6.684187574007687,-2.605712645010396,-3.065672089596532,-2.9746758252816363,-3.2065138699390303,-10.55153868468568]}],{}, {displayModeBar: false});</script>
<div class=" row "><div class="col-md-6"><div id="beta.1"></div><script>Plotly.newPlot('beta.1', [{"x":[3.70457,3.7106136,3.7166571999999998,3.7227008,3.7287444,3.734788,3.7408316,3.7468752,3.7529187999999998,3.7589624,3.765006,3.7710496,3.7770932,3.7831368,3.7891804000000002,3.795224,3.8012676,3.8073112,3.8133548,3.8193984,3.8254420000000002,3.8314856,3.8375292,3.8435728,3.8496164,3.8556600000000003,3.8617036000000002,3.8677472,3.8737908,3.8798344,3.885878,3.8919216000000003,3.8979652000000002,3.9040088,3.9100524,3.916096,3.9221396000000004,3.9281832000000003,3.9342268000000002,3.9402704,3.946314,3.9523576,3.9584012,3.9644448000000003,3.9704884000000003,3.976532,3.9825756,3.9886192000000005,3.9946628000000004,4.0007064,4.00675],"type":"bar","y":[3,1,2,2,2,1,3,2,11,10,6,7,10,18,23,25,17,17,19,19,23,23,23,16,17,22,17,17,16,20,14,12,16,12,4,11,10,3,7,4,3,3,3,2,1,2,0,0,0,0,1]}],{"height":300,"margin":{"l":50,"pad":4,"t":10,"b":30,"r":25}}, {displayModeBar: false});</script></div><div class="col-md-6"><div id="beta.2"></div><script>Plotly.newPlot('beta.2', [{"x":[-0.454195,-0.45019302,-0.44619104000000004,-0.44218906,-0.43818708,-0.4341851,-0.43018312000000003,-0.42618114,-0.42217916,-0.41817718000000004,-0.4141752,-0.41017322,-0.40617124,-0.40216926000000003,-0.39816728,-0.3941653,-0.39016332,-0.38616134,-0.38215936,-0.37815738,-0.3741554,-0.37015342,-0.36615144,-0.36214946000000003,-0.35814748,-0.3541455,-0.35014352,-0.34614153999999997,-0.34213956,-0.33813758,-0.3341356,-0.33013362,-0.32613164,-0.32212966,-0.31812768,-0.3141257,-0.31012372,-0.30612174000000003,-0.30211975999999996,-0.29811778,-0.2941158,-0.29011381999999997,-0.28611184,-0.28210986,-0.27810788,-0.2741059,-0.27010392,-0.26610194,-0.26209996,-0.25809798,-0.254096],"type":"bar","y":[2,0,2,3,4,1,3,5,7,8,10,3,7,12,20,14,16,14,16,20,25,31,26,19,18,20,16,28,26,16,20,16,13,11,10,3,9,7,7,2,5,1,1,2,0,0,0,0,0,0,1]}],{"height":300,"margin":{"l":50,"pad":4,"t":10,"b":30,"r":25}}, {displayModeBar: false});</script></div></div>
</div></div></div></body></html>
